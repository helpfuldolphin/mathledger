{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://mathledger.org/schemas/governance_signal.json",
  "title": "Governance Signal",
  "description": "A structured, machine-readable assertion about the state of a component or process within the organism, used for real-time governance and decision-making.",
  "type": "object",
  "properties": {
    "signalId": {
      "description": "A unique identifier for this specific signal instance, such as a UUID. Provides idempotency.",
      "type": "string",
      "format": "uuid"
    },
    "originatorId": {
      "description": "The unique, verifiable identifier of the component emitting the signal (e.g., a cryptographic identity of the substrate, slice, or agent).",
      "type": "string",
      "pattern": "^[a-zA-Z0-9_\\-:.@]+$"
    },
    "timestamp": {
      "description": "The ISO 8601 UTC timestamp of when the signal was generated.",
      "type": "string",
      "format": "date-time"
    },
    "semanticType": {
      "description": "An enumeration defining the high-level meaning and intent of the signal.",
      "type": "string",
      "enum": [
        "HEARTBEAT_OK",
        "RESOURCE_CONSTRAINT_WARN",
        "BEHAVIORAL_ANOMALY_WARN",
        "INTEGRITY_CHECK_FAIL",
        "SECURITY_THRESHOLD_EXCEEDED",
        "ABORT_GATE_TRIGGERED"
      ]
    },
    "severity": {
      "description": "A numerical representation of the signal's urgency and potential impact.",
      "type": "integer",
      "minimum": 1,
      "maximum": 5
    },
    "ttl": {
      "description": "Time-to-live in seconds. Defines how long the signal should be considered valid by the fusion engine before it expires.",
      "type": "integer",
      "minimum": 1
    },
    "isMonotonic": {
      "description": "A boolean indicating if the state represented by this signal type is expected to be monotonic (i.e., it should only increase or stay the same, never decrease). Useful for detecting regressions.",
      "type": "boolean",
      "default": false
    },
    "payload": {
      "description": "An optional object containing structured data specific to the signal type. This provides the evidence backing the assertion.",
      "type": "object",
      "properties": {
        "metricName": { "type": "string" },
        "value": { "type": ["number", "string", "boolean"] },
        "threshold": { "type": "number" },
        "observedHash": { "type": "string" },
        "expectedHash": { "type": "string" }
      },
      "additionalProperties": true
    },
    "cryptographicMetadata": {
      "description": "Metadata related to the integrity and authenticity of the signal.",
      "type": "object",
      "properties": {
        "signature": {
          "description": "A digital signature of the canonicalized signal object (excluding the signature field itself), created using the originator's private key.",
          "type": "string"
        },
        "publicKey": {
          "description": "The public key corresponding to the private key used for the signature, allowing for verification.",
          "type": "string"
        },
        "signingAlgorithm": {
          "description": "The algorithm used to generate the signature (e.g., ECDSA-P256).",
          "type": "string",
          "enum": ["ECDSA-P256", "RSA-PSS-SHA256"]
        }
      },
      "required": ["signature", "publicKey", "signingAlgorithm"]
    }
  },
  "required": [
    "signalId",
    "originatorId",
    "timestamp",
    "semanticType",
    "severity",
    "ttl",
    "cryptographicMetadata"
  ]
}
