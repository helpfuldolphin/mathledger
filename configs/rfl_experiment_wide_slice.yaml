# ============================================================================
# RFL Experiment: Wide Slice (slice_medium)
# ============================================================================
# Purpose: RFL configuration for Wide Slice experiments targeting slice_medium.
# - Designed for research use with FO cycle logs
# - Conservative step sizes for stability
# - Hermetic mode (no DB required when used with mocked baseline)
#
# STATUS: Phase II / Infrastructure Ready
# - Configuration exists and is validated
# - Metrics logging infrastructure implemented
# - No experimental runs executed yet (no data in results/rfl_wide_slice_runs.jsonl)
# - Phase I evidence uses first-organism-pl slice (see results/fo_rfl_50.jsonl)
# ============================================================================
# 
# Usage:
#   # Convert to JSON for RFLRunner:
#   python -c "import yaml, json; print(json.dumps(yaml.safe_load(open('configs/rfl_experiment_wide_slice.yaml')), indent=2))" > configs/rfl_experiment_wide_slice.json
#
#   # Or use directly with rfl_gate.py (bootstrap analysis):
#   python rfl_gate.py configs/rfl_experiment_wide_slice.yaml
# ============================================================================

experiment_name: "RFL Wide Slice - slice_medium"
metrologist: "Cursor K — RFL Integration Specialist"
version: "1.0.0"

# RFL Runner Configuration (for use with RFLRunner)
rfl_runner_config:
  experiment_id: "rfl_wide_slice"
  num_runs: 30  # 20-50 range, targeting slice_medium (runs 11-30)
  random_seed: 42
  system_id: 1  # Propositional Logic
  
  # Conservative derivation parameters (matching slice_medium from curriculum.yaml)
  derive_steps: 50
  max_breadth: 100
  max_total: 500
  depth_max: 4
  
  # Statistical parameters
  bootstrap_replicates: 10000
  confidence_level: 0.95
  
  # Acceptance criteria
  coverage_threshold: 0.92
  uplift_threshold: 1.0
  
  # Hermetic mode (no DB required)
  database_url: ""  # Empty = hermetic mode
  dual_attestation: false  # Simplified for research
  
  # Abstention discipline
  abstention_tolerance: 0.25
  
  # Curriculum: single slice targeting slice_medium
  curriculum:
    - name: "slice_medium"
      start_run: 1
      end_run: 30
      derive_steps: 50
      max_breadth: 100
      max_total: 500
      depth_max: 4
  
  # Output paths
  artifacts_dir: "artifacts/rfl_wide_slice"
  results_file: "rfl_wide_slice_results.json"
  coverage_file: "rfl_wide_slice_coverage.json"
  curves_file: "rfl_wide_slice_curves.png"

# Bootstrap Gate Configuration (for use with rfl_gate.py)
bootstrap_config:
  method: "bca"
  n_experiments: 20
  n_replicates: 10000
  confidence_level: 0.95
  seed: 42

pass_criteria:
  coverage_lower_bound: 0.92
  uplift_lower_bound: 1.0
  description: "PASS iff coverage₉₅lower ≥ 0.92 AND uplift₉₅lower > 1.0"

data_source:
  mode: "historical"
  path: "docs/progress.md"
  fallback_to_db: false  # Hermetic mode
  db_config:
    host: "localhost"
    port: 5432
    database: "mathledger"
    user: "ml"
    password: null

metrics:
  - name: "success_rate"
    baseline: 0.5
    weight: 1.0
    experiments: 10
  
  - name: "proof_velocity"
    baseline: 1.0
    weight: 2.0
    experiments: 10

output:
  artifacts_dir: "artifacts/rfl_wide_slice"
  results_file: "rfl_wide_slice_results.json"
  coverage_file: "rfl_wide_slice_coverage.json"
  visualization_file: "rfl_wide_slice_curves.png"

commit_template:
  pass: "[PASS] RFL Wide Slice: coverage≥{coverage:.3f} uplift>{uplift:.2f}"
  fail: "[FAIL] RFL Wide Slice: coverage={coverage:.3f} uplift={uplift:.2f}"
  abstain: "[ABSTAIN] RFL Wide Slice: Insufficient data"

